<div *ngIf='errorMessage' class='error' (click)='errorMessage = ""'>
        {{errorMessage}}
</div>
<div class='container-fluid'>
    <div class='row' *ngFor='let rule of rules'>
        <div class='col-xs-1'>
            <div class='row'>
                <div class='col'>{{rule.id}}</div>
                <div class='col'>
                    <label><input #status type="checkbox" 
                        [checked]='rule.status == "enabled"' 
                        (change)='rule.status = status.checked ? "enabled" : "disabled"'/>Active</label>
                </div>
            </div>
            <div class='row'>
                <button (click)='save(rule)' type="button" class='btn btn-dark'>Save</button>
            </div>
        </div>
        <div class='col-xs-2 input-group-xs'>
            <textarea [(ngModel)]="rule.name" class="form-control input-xs" ></textarea>
        </div>
        <div class='col-xs-4'>
            <div class='row' *ngFor='let condition of rule.conditions'>
                <div class='col-xs-12'>
                    <div class='row'>
                        <div class='col-xs-12 input-group-xs'>
                            <input type='text' [(ngModel)]='condition.address' class='form-control input-xs' />
                        </div>
                    </div>
                    <div class='row'>
                        <div class='col-xs-12 input-group-xs'>
                            <select class='input-xs form-control' [(ngModel)]='condition.operator'>
                                <option *ngFor="let o of operators" [value]="o">{{o}}</option>
                            </select>
                        </div>
                    </div>
                    <div class='row' *ngIf='condition.operator != "dx"'>
                        <div class='col-xs-12 input-group-xs'>
                            <input type='text' [(ngModel)]='condition.value' class='form-control input-xs' />
                        </div>
                    </div>
                </div>
            </div>
            <div class='row'>
                <div class='col-xs-12'>
                    <button (click)='newCondition(rule)' type='button' class='btn btn-dark'>Add</button>
                </div>
            </div>
        </div>
        <div class='col-xs-4'>
            <div class='row' *ngFor='let action of rule.actions'>
                <div class='col-xs-12'>
                    <div class='row'>
                        <div class='col-xs-12 input-group'>
                            <input type='text' [(ngModel)]='action.address' class='form-control input-xs' />
                        </div>
                    </div>
                    <div class='row'>
                        <div class='col-xs-12 input-group'>
                            <input type='text' [(ngModel)]='action.method' class='form-control input-xs' />
                        </div>
                    </div>
                    <div class='row indent-1' *ngFor='let body of action.body'>
                        <div class='col-xs-6 input-group'>
                            <input type='text' [(ngModel)]='body.key' class='form-control input-xs' />
                        </div>
                        <div class='col-xs-6 input-group'>
                            <input type='text' [(ngModel)]='body.value' class='form-control input-xs' />
                        </div>
                    </div>
                    <div class='row indent-1'>
                        <div class='col-xs-12'>
                            <button (click)='newBodyEntry(action)' type='button' class='btn btn-dark'>Add</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class='row'>
                <div class='col-xs-12'>
                    <button (click)='newAction(rule)' type='button' class='btn btn-dark'>Add</button>
                </div>
            </div>
        </div>
        <div class='col-xs-1'>
            <button (click)='removeRule(rule)' type='button' class='btn btn-dark'>x</button>
        </div>
    </div>
    <div class='row'>
        <button (click)='newRule()' type='button' class='btn btn-dark'>Add new rule</button>        
    </div>
</div>
